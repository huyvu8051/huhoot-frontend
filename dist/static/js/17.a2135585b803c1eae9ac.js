webpackJsonp([17],{"2o6c":function(e,t){},hFDE:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("B+Sj"),o=n("DmT9"),r=n.n(o),u={components:{FlexLayout:s.a},data:function(){return{challenge:{},socket:{},question:{},answers:[],studentAnswered:0,ready:!1}},created:function(){var e=this.$router.currentRoute.name,t=this.$route.query.challengeId;this.joinChallenge(t,e),console.log("after join chall"),this.socket=this.connectSocket(),this.registerEvent(this.socket)},beforeDestroy:function(){this.removeEventBusListener(),this.removeSocketListener(this.socket)},methods:{joinChallenge:function(e,t){console.log("currName",t);var n=t;switch(t){case"host.ready":case"host.preview":case"host.ask":return n="host.reAsk",void this.$router.push({name:n,query:{challengeId:e}}).catch(function(e){return e});case"host.get":n="host.wait";break;case"host.show":n="host.organize.rank"}this.$router.push({name:n,query:{challengeId:e}}).catch(function(e){return e})},connectSocket:function(){var e=this,t=this.$socketUrl,n=r.a.connect(t);return n.on("connected",function(e){console.log(e)}).emit("registerHostSocket",{challengeId:this.$route.query.challengeId,token:this.$store.state.token}),n.on("registerSuccess",function(t){e.challenge=t,e.ready=!0}),n.on("joinError",function(t){e.$eventBus.$emit("nofication",{message:"Cann't connect to room!!!",status:"error"}),e.$router.push({name:"HOST"}).catch(function(e){return e})}),n},registerEvent:function(e){var t=this;e.on("startChallenge",function(){t.$router.push({name:"host.start",query:{challengeId:t.$route.query.challengeId}}).catch(function(e){return e})}),e.on("publishQuestion",function(e){t.question=e.question,t.answers=e.answers,t.studentAnswered=0,t.$router.push({name:"host.ready",query:{challengeId:t.$route.query.challengeId,questionId:t.question.id}}).catch(function(e){return e})}),e.on("showCorrectAnswer",function(e){t.answers=e.answers,console.log(t.answers),t.$router.push({name:"host.show",query:{challengeId:t.$route.query.challengeId,questionId:t.$route.query.questionId}}).catch(function(e){return e})}),e.on("studentAnswer",function(){t.studentAnswered++,console.log(t.studentAnswered)}),e.on("endChallenge",function(){t.$router.push({name:"host.finish",query:{challengeId:t.$route.query.challengeId}}).catch(function(e){return e})}),this.$eventBus.$on("reAsk",function(e){var n=e.question,s=e.answers;t.question=n,t.answers=s,t.$router.push({name:"host.ask",query:{challengeId:t.$route.query.challengeId,questionId:t.question.id}}).catch(function(e){return e})})},removeSocketListener:function(e){e.off("connected"),e.off("registerSuccess"),e.off("joinError"),e.off("startChallenge"),e.off("publishQuestion"),e.off("showCorrectAnswer"),e.off("endChallenge")},removeEventBusListener:function(){this.$eventBus.$off("reAsk")}}},c={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-main",[t("FlexLayout",[t("router-view",{attrs:{challenge:this.challenge,socket:this.socket,question:this.question,answers:this.answers,studentAnswered:this.studentAnswered,theLastQuestion:this.question.theLastQuestion,ready:this.ready}})],1)],1)},staticRenderFns:[]};var i=n("VU/8")(u,c,!1,function(e){n("2o6c")},null,null);t.default=i.exports}});
//# sourceMappingURL=17.a2135585b803c1eae9ac.js.map